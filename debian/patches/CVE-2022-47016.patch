Backported:

From e86752820993a00e3d28350cbe46878ba95d9012 Mon Sep 17 00:00:00 2001
From: nicm <nicm>
Date: Wed, 24 Aug 2022 07:22:30 +0000
Subject: [PATCH] Check for NULL returns from bufferevent_new.
diff --git a/window.c b/window.c
index 254ccc8..40614f4 100644
--- a/window.c
+++ b/window.c
@@ -911,6 +911,8 @@ window_pane_set_event(struct window_pane *wp)
 	wp->event = bufferevent_new(wp->fd, window_pane_read_callback,
 	    NULL, window_pane_error_callback, wp);
 
+	if (wp->event == NULL)
+		fatalx("out of memory");
 	bufferevent_setwatermark(wp->event, EV_READ, 0, READ_SIZE);
 	bufferevent_enable(wp->event, EV_READ|EV_WRITE);
 }
